# Experiments
Summary of some done experiments.

## General

### CIFAR10: ResNet18
|                |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:---------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic  |      95.246 |    0.952455 |    0.195328 |   0.195328 |  0.0466204 |  0.0219369 |                  0.948836 |                 0.937981 |
| dropout        |      94.524 |    0.945245 |    0.163241 |   0.163241 |  0.012984  |  0.0135304 |                  0.937801 |                 0.913964 |
| sngp           |      95.052 |    0.950574 |    0.184833 |   0.184833 |  0.0221541 |  0.0174754 |                  0.944551 |                 0.939294 |
| sngp_optimized |      95.09  |    0.950956 |    0.17101  |   0.17101  |  0.0291983 |  0.018145  |                  0.954457 |                 0.949831 |

### CIFAR10: Wide-ResNet-28-10
*TBD:*
|                     |   test_acc1 |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------------|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| wideresnet2810      |      96.05  |    0.159374 |   0.159374 |  0.041665  |  0.021761  |                  0.892527 |                 0.884355 |
| wideresnet2810_mc   |      96.28  |    0.120258 |   0.120258 |  0.012486  |  0.014515  |                  0.918307 |                 0.905463 |
| wideresnet2810_sngp |      95.74  |    0.205887 |   0.205887 |  0.058210  |  0.025145	 |                  0.848497 |                 0.857889 |
| wideresnet2810_ens  |      96.61  |    0.114379 |   0.114379 |  0.018241  |  0.015642  |                  0.919876 |                 0.908626 |

## Varying number of Samples
- Dataset: CIFAR10
- Model: ResNet18

**100 samples:**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      21.786 |    0.218773 |     6.47972 |    6.47972 |  0.598752  |  0.204481  |                  0.442578 |                 0.458425 |
| dropout       |      23.25  |    0.22962  |     2.39245 |    2.39245 |  0.206218  |  0.0790917 |                  0.520735 |                 0.522295 |
| sngp          |      19.204 |    0.191445 |     2.24835 |    2.24835 |  0.0730814 |  0.0375863 |                  0.573709 |                 0.580036 |

**500 samples:**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      36.972 |    0.376229 |     4.48459 |    4.48459 |  0.489655  |  0.167565  |                  0.529521 |                 0.513182 |
| dropout       |      36.872 |    0.373766 |     2.06531 |    2.06531 |  0.197088  |  0.0736805 |                  0.58147  |                 0.541315 |
| sngp          |      29.784 |    0.300027 |     1.98948 |    1.98948 |  0.0548906 |  0.0317618 |                  0.538086 |                 0.528331 |


**1000 samples:**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      46.09  |    0.461502 |     3.78485 |    3.78485 |  0.421722  |  0.144278  |                  0.579264 |                 0.546797 |
| dropout       |      45.168 |    0.45124  |     1.85492 |    1.85492 |  0.205627  |  0.0747796 |                  0.595518 |                 0.549202 |
| sngp          |      37.596 |    0.376732 |     1.80971 |    1.80971 |  0.0940506 |  0.0415746 |                  0.576144 |                 0.56233  |

**5000 samples:**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      74.07  |    0.740297 |    1.32585  |   1.32585  |  0.195636  |  0.0692491 |                  0.67131  |                 0.607568 |
| dropout       |      73.514 |    0.73419  |    0.888401 |   0.888401 |  0.0922904 |  0.0376273 |                  0.729284 |                 0.6547   |
| sngp          |      75.328 |    0.753065 |    0.805763 |   0.805763 |  0.109161  |  0.0432577 |                  0.757657 |                 0.691201 |

**10000 samples:**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      86.872 |    0.868456 |    0.574526 |   0.574526 |  0.0946655 |  0.0368469 |                  0.835438 |                 0.778633 |
| dropout       |      86.108 |    0.860599 |    0.439238 |   0.439238 |  0.037582  |  0.0202042 |                  0.841878 |                 0.78328  |
| sngp          |      87.006 |    0.869585 |    0.456551 |   0.456551 |  0.0747069 |  0.0303727 |                  0.908565 |                 0.886993 |

## SNGP
Default Config:
```
name : resnet18_sngp
spectral_norm:
  use_spectral_norm: True
  coeff: 6
  n_power_iterations: 1
gp:
  kernel_scale: 1
  num_inducing: 1024
  normalize_input: False
  scale_random_features: False
  cov_momentum: -1
  ridge_penalty: 1
  mean_field_factor: 0.393 # = pi / 8
optimizer:
  lr: 0.08
  weight_decay: 3e-4
  momentum: .9
```

### Kernel Scale (5 reps)
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      95.246 |    0.952455 |    0.195328 |   0.195328 |  0.0466204 |  0.0219369 |                  0.948836 |                 0.937981 |
| scale10       |      60.048 |    0.564594 |    1.1089   |   1.1089   |  0.0626145 |  0.0221859 |                  0.663306 |                 0.628446 |
| scale20       |      94.762 |    0.94776  |    0.314677 |   0.314677 |  0.15587   |  0.0519391 |                  0.88018  |                 0.839979 |
| scale50       |      94.664 |    0.946702 |    0.21547  |   0.21547  |  0.0515909 |  0.0227014 |                  0.942961 |                 0.932117 |
| scale100      |      95.108 |    0.951184 |    0.181033 |   0.181033 |  0.0197899 |  0.0165821 |                  0.95119  |                 0.950047 |
| scale200      |      95.09  |    0.950956 |    0.17101  |   0.17101  |  0.0291983 |  0.018145  |                  0.954457 |                 0.949831 |