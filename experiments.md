# Experiments
Summary of some done experiments.

## General

### CIFAR10: ResNet18
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      95.246 |    0.952455 |    0.195328 |   0.195328 |  0.0466204 |  0.0219369 |                  0.948836 |                 0.937981 |
| dropout       |      94.524 |    0.945245 |    0.163241 |   0.163241 |  0.012984  |  0.0135304 |                  0.937801 |                 0.913964 |
| sngp          |      95.162 |    0.951741 |    0.167379 |   0.167379 |  0.0250875 |  0.0170292 |                  0.956285 |                 0.952656 |

### CIFAR10: Wide-ResNet-28-10
TODO

## Varying number of Samples
- Dataset: CIFAR10
- Model: ResNet18

**n_samples = 100**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      21.786 |    0.218773 |     6.47972 |    6.47972 |   0.598752 |  0.204481  |                  0.442578 |                 0.458425 |
| dropout       |      23.25  |    0.22962  |     2.39245 |    2.39245 |   0.206218 |  0.0790917 |                  0.520735 |                 0.522295 |
| sngp          |      20.004 |    0.197505 |     2.33963 |    2.33963 |   0.149344 |  0.0602393 |                  0.560689 |                 0.564648 |

**n_samples = 500**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      36.972 |    0.376229 |     4.48459 |    4.48459 |  0.489655  |  0.167565  |                  0.529521 |                 0.513182 |
| dropout       |      36.872 |    0.373766 |     2.06531 |    2.06531 |  0.197088  |  0.0736805 |                  0.58147  |                 0.541315 |
| sngp          |      30.144 |    0.304182 |     1.9451  |    1.9451  |  0.0218425 |  0.0275755 |                  0.58646  |                 0.570345 |

**n_samples = 1000**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      46.09  |    0.461502 |     3.78485 |    3.78485 |  0.421722  |  0.144278  |                  0.579264 |                 0.546797 |
| dropout       |      45.168 |    0.45124  |     1.85492 |    1.85492 |  0.205627  |  0.0747796 |                  0.595518 |                 0.549202 |
| sngp          |      38.282 |    0.383865 |     1.7507  |    1.7507  |  0.0252745 |  0.0273992 |                  0.599118 |                 0.566247 |

**n_samples = 5000**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      74.07  |    0.740297 |    1.32585  |   1.32585  |  0.195636  |  0.0692491 |                  0.67131  |                 0.607568 |
| dropout       |      73.514 |    0.73419  |    0.888401 |   0.888401 |  0.0922904 |  0.0376273 |                  0.729284 |                 0.6547   |
| sngp          |      73.662 |    0.736284 |    0.804869 |   0.804869 |  0.0417135 |  0.0267903 |                  0.743652 |                 0.676564 |

**n_samples = 10000**
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      86.872 |    0.868456 |    0.574526 |   0.574526 |  0.0946655 |  0.0368469 |                  0.835438 |                 0.778633 |
| dropout       |      86.108 |    0.860599 |    0.439238 |   0.439238 |  0.037582  |  0.0202042 |                  0.841878 |                 0.78328  |
| sngp          |      86.586 |    0.865808 |    0.433273 |   0.433273 |  0.0238866 |  0.0192603 |                  0.900837 |                 0.869579 |


## SNGP Parameters
Default Config:
```
name : resnet18_sngp
spectral_norm:
  use_spectral_norm: True
  coeff: 6
  n_power_iterations: 1
gp:
  kernel_scale: 1
  num_inducing: 1024
  normalize_input: False
  scale_random_features: False
  cov_momentum: -1
  ridge_penalty: 1
  mean_field_factor: 0.393 # = pi / 8
optimizer:
  lr: 0.08
  weight_decay: 3e-4
  momentum: .9
```

### Kernel Scale (5 reps)
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      95.246 |    0.952455 |    0.195328 |   0.195328 |  0.0466204 |  0.0219369 |                  0.948836 |                 0.937981 |
| scale10       |      60.048 |    0.564594 |    1.1089   |   1.1089   |  0.0626145 |  0.0221859 |                  0.663306 |                 0.628446 |
| scale20       |      94.762 |    0.94776  |    0.314677 |   0.314677 |  0.15587   |  0.0519391 |                  0.88018  |                 0.839979 |
| scale50       |      94.664 |    0.946702 |    0.21547  |   0.21547  |  0.0515909 |  0.0227014 |                  0.942961 |                 0.932117 |
| scale100      |      95.108 |    0.951184 |    0.181033 |   0.181033 |  0.0197899 |  0.0165821 |                  0.95119  |                 0.950047 |
| scale200      |      95.09  |    0.950956 |    0.17101  |   0.17101  |  0.0291983 |  0.018145  |                  0.954457 |                 0.949831 |

### Kernel Scale with few samples (10 reps)
|               |   test_acc1 |   test_prec |   test_loss |   test_nll |   test_tce |   test_mce |   test_SVHN_entropy_auroc |   test_SVHN_entropy_aupr |
|:--------------|------------:|------------:|------------:|-----------:|-----------:|-----------:|--------------------------:|-------------------------:|
| deterministic |      36.972 |    0.376229 |     4.48459 |    4.48459 |  0.489655  |  0.167565  |                  0.529521 |                 0.513182 |
| scale10       |      22.956 |    0.22522  |     2.14318 |    2.14318 |  0.0474699 |  0.0258593 |                  0.455901 |                 0.479687 |
| scale20       |      25.225 |    0.253414 |     2.09009 |    2.09009 |  0.0461334 |  0.0283971 |                  0.515942 |                 0.529443 |
| scale50       |      27.775 |    0.279783 |     2.04805 |    2.04805 |  0.0564615 |  0.0322963 |                  0.511154 |                 0.510691 |
| scale100      |      29.183 |    0.296035 |     2.00324 |    2.00324 |  0.0463272 |  0.0312891 |                  0.539377 |                 0.538685 |
| scale200      |      31.136 |    0.313836 |     1.93925 |    1.93925 |  0.030038  |  0.0286342 |                  0.552744 |                 0.54963  |
| scale400      |      32.195 |    0.325044 |     1.93969 |    1.93969 |  0.100927  |  0.0451228 |                  0.583337 |                 0.565229 |
| scale800      |      33.651 |    0.339866 |     2.06292 |    2.06292 |  0.196458  |  0.0738291 |                  0.566611 |                 0.554122 |
| scale1600     |      34.906 |    0.354693 |     2.17713 |    2.17713 |  0.256384  |  0.0924137 |                  0.559082 |                 0.526667 |
| scale3200     |      34.524 |    0.349219 |     2.31054 |    2.31054 |  0.293956  |  0.104008  |                  0.551061 |                 0.523129 |

### Spectral Normalization Bound t(5 reps)